#!/bin/bash

### This script regenerates the packaged html templates, copies any needed files
### (read: config files) to their proper place, and packages the turtl XPI file.
###
### Note that this script is meant to be run in the top-level addon folder, not
### not in the scripts/ folder.

# ------------------------------------------------------------------------------
# config section
# ------------------------------------------------------------------------------
# path to cfx
JPM=$(which jpm)
# the resulting XPI file (*must* be the same as what cfx xpi produces)
XPI=firefox.xpi

mkdir -p release/

# package the addon
echo "Packaging addon (via cfx)."
rm -f *.xpi
$JPM xpi > /dev/null

mv `ls *.xpi | head -1` ../$XPI

echo "Complete. Created fully-packaged file: release/$XPI."

